{"version":3,"sources":["webpack:///src/components/game/unlimited.vue","webpack:///./src/components/game/unlimited.vue?56b6","webpack:///./src/components/game/unlimited.vue"],"names":["unlimited","data","baseUrl","common","ossUrl","mode","this","$route","query","matching","rival","rule","batch_id","myScore","rivalScore","score","consuming","consumingText","max_duration","userInfo","$store","state","beginTime","endTime","cacheData","beginData","gameStatus","timingLeftStyle","timingRightStyle","isRotate","timingCount","countdownTimer","currentQuestion","questionIndex","isCorrect","answerList","isCanDoAnswer","isPkWin","audioSrc","rivalAnswerStatus","wrongCount","nextTimer","gameTimer","audioTimer","created","init","beforeDestroy","clearTimeout","methods","answerBeginByUnlimited","getQuestion","_this","$api","then","res","code","setTimeout","checkIsAudio","$popup","msg","getUnlimitedQuestion","_this2","_this3","answerBegin","unlimitedModeBegin","index","length","pkModeEnd","options_list","map","a","arr","correct_list","i","indexOf","that","Date","getTime","audio","document","getElementById","play","pause","currentTime","$wx","ready","removeEventListener","fn","addEventListener","playAudio","isIOS","stopAudio","audi0","_this4","console","log","answerEnd","_this5","game","pkModeBegin","$nextTick","forEach","src","source","createElement","type","split","appendChild","load","doAnswer","bool","some","question_type","checkISCorrect","checkAnswer","filter","$forceUpdate","_this6","one_correct_score","questionReply","_this7","a_length","c_length","is","every","duration","selecteds","String","param","question_id","id","oneMoreTry","goBack","window","history","go","watch","v","m","s","filters","duration2str","Math","ceil","game_unlimited","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","class","success","fail","attrs","avatar","_e","rotate","style","grey","staticStyle","display","preload","title","image","on","click","_f","_l","q","key","choose","correct","$event","_m","staticRenderFns","overflow","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/14.60523ba5930b6ec9b797.js","sourcesContent":["<template>\n    <div class=\"game-wrap\">\n        <div class=\"game-container\" v-if=\"gameStatus !== 'matching' && gameStatus!=='end'\">\n            <div class=\"game-player\">\n                <div class=\"game-player-self\">\n                    <div class=\"game-player-score\">{{myScore}}</div>\n                    <div :class=\"['game-player-avatar',{success:isCorrect=='success'},{fail:isCorrect=='fail'}]\">\n                        <img :src=\"userInfo.avatar\">\n                    </div>\n                </div>\n                <div class=\"game-timing\" v-if=\"(gameStatus=='start' || gameStatus=='checking') && mode!=='unlimited'\">\n                    <div class=\"game-timing-left\"><i :class=\"{rotate:isRotate}\" :style=\"timingLeftStyle\"></i></div>\n                    <div class=\"game-timing-right\"><i :class=\"{rotate:isRotate}\" :style=\"timingRightStyle\"></i></div>\n                    <span>{{timingCount}}</span>\n                </div>\n                <div class=\"game-remaining\">\n                    <i :class=\"{grey:wrongCount>0}\"></i>\n                    <i :class=\"{grey:wrongCount>1}\"></i>\n                    <i :class=\"{grey:wrongCount>2}\"></i>\n                </div>\n            </div>\n            <div :class=\"['game-question-type',currentQuestion.question_type]\" v-if=\"gameStatus=='prepare'\">\n                <label>第{{questionIndex+1}}题</label>\n                <div class=\"q-type\">{{currentQuestion.question_type == \"single\" ? \"单选题\" : \"多选题\"}}</div>\n            </div>\n            <div style=\"display: none;\">\n                <audio id=\"qa-audio\" :src=\"audioSrc\" preload=\"preload\"></audio>\n            </div>\n            <div class=\"game-qa\" v-if=\"gameStatus=='start' || gameStatus=='checking'\">\n                <div class=\"game-question\">\n                    {{currentQuestion.title}}\n                    <img v-if=\"currentQuestion.image\" :src=\"currentQuestion.image\">\n                    <div class=\"game-q-audio\" v-if=\"currentQuestion.audio\" @click=\"playAudio\">\n                        {{currentQuestion.duration|duration2str}}<span>{{isIOS ? \"  点击播放\":\"\"}}</span>\n                    </div>\n                </div>\n                <ul class=\"game-answer-list\">\n                    <li v-for=\"(q,i) in currentQuestion.options_list\" :key=\"i\" @click=\"doAnswer(i)\"\n                        :class=\"{\n                            choose : answerList[i]==1,\n                            correct: currentQuestion.correct_list[i] && gameStatus=='checking',\n                            success: currentQuestion.correct_list[i] && answerList[i]==1 && gameStatus=='checking',\n                            fail : !currentQuestion.correct_list[i] && answerList[i]==1 && gameStatus=='checking'\n                        }\"\n                    >{{q}}</li>\n                </ul>\n                <div :class=\"['game-answer-result',isCorrect ? isCorrect : '']\" v-if=\"gameStatus=='checking'\">\n                    <span v-if=\"isCorrect=='fail'\">很遗憾，回答错误</span>\n                    <span v-if=\"isCorrect=='success'\">恭喜您，回答正确</span>\n                </div>\n            </div>\n        </div>\n\n        <div :class=\"['layer-pk-mode','layer-pk-mode-unlimited',isPkWin?'success':'fail']\" v-if=\"gameStatus == 'end'\">\n            <div class=\"gameover-result-title\">{{isPkWin?\"胜利\":\"失败\"}}</div>\n            <div class=\"gameover-result-content\">\n                <div style=\"overflow: hidden;\">\n                    <div class=\"myself\">\n                        <div class=\"avatar\"></div>\n                    </div>\n                </div>\n                <label class=\"game-this-round\"><em>本局奖励</em></label>\n                <div class=\"game-score-count\">积分+{{score}}</div>\n                <div class=\"gameover-btns\">\n                    <a class=\"goback\" @click=\"goBack\">返回</a>\n                    <a class=\"try-again\" @click=\"oneMoreTry()\">再来一局</a>\n                </div>\n            </div>\n        </div>\n\n\n    </div>\n</template>\n\n<script>\n    import '../../assets/scss/game.scss'\n    import common from '../../assets/js/common'\n    export default {\n        data() {\n            return {\n                baseUrl : common.ossUrl,\n                mode : this.$route.query.mode || 'unlimited',      //模式\n                matching : true,                    //匹配状态 true匹配中\n                rival : {},                          //对手  \n                rule : {}, \n                batch_id : 0,\n                myScore : 0,\n                rivalScore : 0,\n                score : 0,\n                consuming : 0,                      //耗时\n                consumingText : '00:00',            //耗时\n                max_duration : 20,\n                userInfo : this.$store.state.userInfo,\n                beginTime : '',\n                endTime : '',\n                cacheData : {},\n                beginData : {},\n                gameStatus : 'matching',            //游戏状态 matching 匹配中 prepare 准备 start 开始 checking 检查答案 end 结束\n                timingLeftStyle : '',\n                timingRightStyle : '',\n                isRotate : false,\n                timingCount : 10,\n                countdownTimer : null,\n                currentQuestion : {},\n                questionIndex : 0,\n                isCorrect : '',\n                answerList : [],\n                isCanDoAnswer : true,\n                isPkWin : false,\n                audioSrc : false,\n                rivalAnswerStatus : '',\n                wrongCount : 0,\n                nextTimer : null,\n                gameTimer : null,\n                audioTimer : null\n            }\n        },\n        created() {\n            this.init();\n        },\n        beforeDestroy(){\n            clearTimeout(this.nextTimer);\n            this.nextTimer = null;\n            clearTimeout(this.gameTimer);\n            this.gameTimer = null;\n            clearTimeout(this.audioTimer);\n            this.audioTimer = null;\n        },\n        methods: {\n            init(){\n                this.matching = true;\n                this.gameStatus = 'matching';\n                this.isCanDoAnswer = true;\n                this.beginData = [];\n                this.questionIndex = 0;\n                this.timingLeftStyle = '';\n                this.timingRightStyle = '';\n                this.consuming = 0;\n                this.countdownTimer = null;\n                this.nextTimer = null;\n                this.gameTimer = null;\n                this.audioTimer = null;\n                this.myScore = 0;\n                this.rivalScore = 0;\n                this.isCorrect= '';\n                this.rivalAnswerStatus = '';\n                this.wrongCount = 0;\n                this.answerBeginByUnlimited();\n            },\n            /**\n             * PK模式开始答题\n             */\n            getQuestion(batch_id){\n                this.$api.getQuestion({\n                    batch_id : batch_id\n                }).then(res=>{\n                    if(res.code == 1){\n                        this.beginData = res.data;\n                        setTimeout(()=>{\n                            this.checkIsAudio(0);\n                            // this.pkModeBegin(0);\n                        },2000)\n                    }else{\n                        this.$popup(res.msg);\n                    }\n                })\n            },\n            getUnlimitedQuestion(batch_id){\n                this.$api.getQuestion({\n                    batch_id : batch_id\n                }).then(res=>{\n                    if(res.code == 1){\n                        this.beginData = res.data;\n                        this.checkIsAudio(0);\n                    }else{\n                        this.$popup(res.msg);\n                    }\n                })\n            },\n            /**\n             * 无限模式开始答题\n             */\n            answerBeginByUnlimited(){\n                this.gameStatus = 'matching';\n                this.$api.answerBegin({\n                    mode : this.mode\n                }).then(res=>{\n                    if(res.code == 1){\n                        this.batch_id = res.data.batch_id;\n                        this.rule = res.data.rule;\n                        this.getUnlimitedQuestion(res.data.batch_id);\n                    }else{\n                        this.$popup(res.msg);\n                    }\n                })\n                // this.beginData = this.makeQuestion();\n                // this.pkModeBegin(0);\n            },\n            /**\n            *   PK模式开始游戏\n            */\n            \n            unlimitedModeBegin(index){\n                if(index >= this.beginData.length){\n                    this.pkModeEnd();\n                    return;\n                }\n                this.isCanDoAnswer = true;\n                this.gameStatus = 'prepare';\n                this.questionIndex = index;\n                this.currentQuestion = this.beginData[this.questionIndex];\n                this.isCorrect = '';\n                this.rivalAnswerStatus = '';\n                this.answerList = this.currentQuestion.options_list.map(a=>0);\n                // this.currentQuestion.answerList = this.currentQuestion.options_list.map(a=>0);\n                var arr = this.currentQuestion.correct_list;\n                this.currentQuestion.correct_list = this.currentQuestion.options_list.map((a,i)=>{\n                    return arr.indexOf(i) > -1;\n                })\n                var that = this;\n                this.gameTimer = setTimeout(()=>{\n                    that.gameStatus = 'start';\n                    that.checkIsAudio(that.questionIndex+1);\n                    that.beginTime = new Date().getTime();\n                    if(that.currentQuestion.audio){\n                        var audio = document.getElementById(\"qa-audio\");\n                        // audio.setAttribute(\"autoplay\",\"autoplay\");\n                        audio.play();\n                        audio.pause();\n                        audio.currentTime = 0;\n                        that.audioTimer = setTimeout(()=>{\n                            that.$wx.ready(()=>{\n                                audio.play();\n                                audio.removeEventListener(\"loadedmetadata\",fn,false)\n                            })\n                        },500)\n                        audio.addEventListener(\"loadedmetadata\",fn,false)\n                    }\n                    \n                },1500)\n            },\n            playAudio(){\n                if(!this.isIOS){\n                    return;\n                }\n                var audio = document.getElementById(\"qa-audio\");\n                audio.play();\n            },\n            stopAudio(){\n                var audio = document.getElementById(\"qa-audio\");\n                audio.pause();\n                audi0.currentTime = 0;\n            },\n            /**\n            *   PK模式结束游戏\n            */\n            pkModeEnd(){\n                console.log(\"game over\");\n                this.$api.answerEnd({\n                    batch_id : this.batch_id\n                }).then(res=>{\n                    this.gameStatus = 'end';\n                    this.isPkWin = this.wrongCount < 4;\n                    if(res.code==1){\n                        this.score = res.data.score;\n                    }else{\n                        this.$popup(res.msg);\n                    }\n                })\n            },\n            /**\n            *   检查下一题是否为音频题 如果是则预加载音频 并获取时长\n            */\n            checkIsAudio(index){\n                if(index >= this.beginData.length){\n                    return;\n                }\n                var game = this.beginData[index];\n                if(game.audio){\n                    if(index == 0){\n                        for(var i =0;i<this.beginData.length;i++){\n                            if(!this.beginData[i].audio){\n                                this.beginData[0] = this.beginData[i];\n                                this.beginData[i] = game;\n                                break;\n                            }\n                        }\n                        this.pkModeBegin(index);\n                        return;\n                    }\n                    // this.audioSrc = game.audio;\n                    this.$nextTick(()=>{\n                        var audio = document.getElementById(\"qa-audio\");\n                        if(!audio){\n                            return;\n                        }\n                        game.audio.forEach(src=>{\n                            var source = document.createElement(\"source\");\n                            var type = src.split(\".\")[1];\n                            source.type = type == \"ogg\" ? \"audio/ogg\" : \"audio/mpeg\";\n                            source.src = this.baseUrl + src;\n                            audio.appendChild(source);\n                        })\n\n                        audio.load();\n                        // audio.oncanplay = ()=>{\n                        //     this.beginData[index].duration = audio.duration;\n                        //     if(index==0 && this.mode == 'unlimited'){\n                        //         this.unlimitedModeBegin(index);\n                        //     }\n                        // }\n                    })\n                }else{\n                    if(index==0 && this.mode == 'pk'){\n                        this.pkModeBegin(index);\n                    }\n                    if(index==0 && this.mode == 'unlimited'){\n                        this.unlimitedModeBegin(index);\n                    }\n                }\n            },\n            /**\n            *   选择答题选项\n            */\n            doAnswer(index){\n                if(!this.isCanDoAnswer){\n                    return;\n                }\n                var bool = this.answerList.some(a=>a);\n\n                if(this.currentQuestion.question_type == 'single'){\n                    if(!bool){\n                        this.answerList[index] = 1;\n                        this.endTime = new Date().getTime();\n                        var bool = this.checkISCorrect();\n                        this.isCorrect = bool ? \"success\" : \"fail\";\n                        this.checkAnswer();\n                    }\n                }else{\n                    this.answerList[index] = !this.answerList[index];\n                    var length = this.answerList.filter(a=>a).length;\n                    var corrleng = this.currentQuestion.correct_list.filter(a=>a).length;\n                    if(length == corrleng){\n                        this.endTime = new Date().getTime();\n                        this.checkAnswer();\n                    }\n                }\n                this.$forceUpdate();\n                \n            },\n            /**\n            *   选择选项后检查答案是否正确\n            */\n            checkAnswer(){\n                this.isCanDoAnswer = false;\n                this.gameStatus = 'checking';\n                var bool = this.checkISCorrect();\n                this.isCorrect = bool ? \"success\" : \"fail\";\n                this.wrongCount += bool ? 0 : 1;\n                this.myScore+= bool ? this.rule.one_correct_score : 0;\n                this.questionReply();\n                this.nextTimer = setTimeout(()=>{\n                    if(this.wrongCount >= 3){\n                        this.pkModeEnd();\n                    }else{\n                        this.unlimitedModeBegin(this.questionIndex+1);\n                    }\n                },2000)\n                \n            },\n            checkISCorrect(){\n                var a_length = this.answerList.filter(a=>a).length;\n                var c_length = this.currentQuestion.correct_list.filter(a=>a).length;\n                var is = this.currentQuestion.correct_list.every((a,i)=>{\n                    return !!a == !!this.answerList[i];\n                })\n                return a_length==c_length && is;\n            },\n            questionReply(){\n                var duration = ((this.endTime||new Date().getTime()) - this.beginTime)/1000;\n                // console.log(this.endTime , this.beginTime,duration);\n                var selecteds = this.answerList.map((a,i)=>{\n                        return a ? String(i) : '';\n                    }).filter(a=>a);\n                var param = {\n                    batch_id : this.batch_id,\n                    question_id : this.currentQuestion.id,\n                    selecteds : selecteds,\n                    duration : duration\n                }\n                if(!selecteds.length){\n                    param.selecteds['0'] = ''\n                }\n                this.$api.questionReply(param).then(res=>{\n\n                })\n            },\n            /**\n            *   再来一局\n            */\n            oneMoreTry(){\n                this.init();\n            },\n            goBack(){\n                window.history.go(-1);\n            }\n        },\n        watch:{\n            consuming(v){\n                var m = v - v % 60,\n                    s = v - m * 60;\n                m = m < 10 ? (\"0\"+m) : m;\n                s = s < 10 ? (\"0\"+s) : s;\n                this.consumingText = m + \":\" + s;\n            }\n        },\n        filters : {\n            duration2str(v){\n                v = Math.ceil(v);\n                var m = v - v % 60,\n                    s = v - m * 60;\n                m = m < 10 ? (\"0\"+m) : m;\n                s = s < 10 ? (\"0\"+s) : s;\n                return m + \":\" + s;\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\">\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/game/unlimited.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"game-wrap\"},[(_vm.gameStatus !== 'matching' && _vm.gameStatus!=='end')?_c('div',{staticClass:\"game-container\"},[_c('div',{staticClass:\"game-player\"},[_c('div',{staticClass:\"game-player-self\"},[_c('div',{staticClass:\"game-player-score\"},[_vm._v(_vm._s(_vm.myScore))]),_vm._v(\" \"),_c('div',{class:['game-player-avatar',{success:_vm.isCorrect=='success'},{fail:_vm.isCorrect=='fail'}]},[_c('img',{attrs:{\"src\":_vm.userInfo.avatar}})])]),_vm._v(\" \"),((_vm.gameStatus=='start' || _vm.gameStatus=='checking') && _vm.mode!=='unlimited')?_c('div',{staticClass:\"game-timing\"},[_c('div',{staticClass:\"game-timing-left\"},[_c('i',{class:{rotate:_vm.isRotate},style:(_vm.timingLeftStyle)})]),_vm._v(\" \"),_c('div',{staticClass:\"game-timing-right\"},[_c('i',{class:{rotate:_vm.isRotate},style:(_vm.timingRightStyle)})]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.timingCount))])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"game-remaining\"},[_c('i',{class:{grey:_vm.wrongCount>0}}),_vm._v(\" \"),_c('i',{class:{grey:_vm.wrongCount>1}}),_vm._v(\" \"),_c('i',{class:{grey:_vm.wrongCount>2}})])]),_vm._v(\" \"),(_vm.gameStatus=='prepare')?_c('div',{class:['game-question-type',_vm.currentQuestion.question_type]},[_c('label',[_vm._v(\"第\"+_vm._s(_vm.questionIndex+1)+\"题\")]),_vm._v(\" \"),_c('div',{staticClass:\"q-type\"},[_vm._v(_vm._s(_vm.currentQuestion.question_type == \"single\" ? \"单选题\" : \"多选题\"))])]):_vm._e(),_vm._v(\" \"),_c('div',{staticStyle:{\"display\":\"none\"}},[_c('audio',{attrs:{\"id\":\"qa-audio\",\"src\":_vm.audioSrc,\"preload\":\"preload\"}})]),_vm._v(\" \"),(_vm.gameStatus=='start' || _vm.gameStatus=='checking')?_c('div',{staticClass:\"game-qa\"},[_c('div',{staticClass:\"game-question\"},[_vm._v(\"\\n                \"+_vm._s(_vm.currentQuestion.title)+\"\\n                \"),(_vm.currentQuestion.image)?_c('img',{attrs:{\"src\":_vm.currentQuestion.image}}):_vm._e(),_vm._v(\" \"),(_vm.currentQuestion.audio)?_c('div',{staticClass:\"game-q-audio\",on:{\"click\":_vm.playAudio}},[_vm._v(\"\\n                    \"+_vm._s(_vm._f(\"duration2str\")(_vm.currentQuestion.duration))),_c('span',[_vm._v(_vm._s(_vm.isIOS ? \"  点击播放\":\"\"))])]):_vm._e()]),_vm._v(\" \"),_c('ul',{staticClass:\"game-answer-list\"},_vm._l((_vm.currentQuestion.options_list),function(q,i){return _c('li',{key:i,class:{\n                        choose : _vm.answerList[i]==1,\n                        correct: _vm.currentQuestion.correct_list[i] && _vm.gameStatus=='checking',\n                        success: _vm.currentQuestion.correct_list[i] && _vm.answerList[i]==1 && _vm.gameStatus=='checking',\n                        fail : !_vm.currentQuestion.correct_list[i] && _vm.answerList[i]==1 && _vm.gameStatus=='checking'\n                    },on:{\"click\":function($event){return _vm.doAnswer(i)}}},[_vm._v(_vm._s(q))])}),0),_vm._v(\" \"),(_vm.gameStatus=='checking')?_c('div',{class:['game-answer-result',_vm.isCorrect ? _vm.isCorrect : '']},[(_vm.isCorrect=='fail')?_c('span',[_vm._v(\"很遗憾，回答错误\")]):_vm._e(),_vm._v(\" \"),(_vm.isCorrect=='success')?_c('span',[_vm._v(\"恭喜您，回答正确\")]):_vm._e()]):_vm._e()]):_vm._e()]):_vm._e(),_vm._v(\" \"),(_vm.gameStatus == 'end')?_c('div',{class:['layer-pk-mode','layer-pk-mode-unlimited',_vm.isPkWin?'success':'fail']},[_c('div',{staticClass:\"gameover-result-title\"},[_vm._v(_vm._s(_vm.isPkWin?\"胜利\":\"失败\"))]),_vm._v(\" \"),_c('div',{staticClass:\"gameover-result-content\"},[_vm._m(0),_vm._v(\" \"),_vm._m(1),_vm._v(\" \"),_c('div',{staticClass:\"game-score-count\"},[_vm._v(\"积分+\"+_vm._s(_vm.score))]),_vm._v(\" \"),_c('div',{staticClass:\"gameover-btns\"},[_c('a',{staticClass:\"goback\",on:{\"click\":_vm.goBack}},[_vm._v(\"返回\")]),_vm._v(\" \"),_c('a',{staticClass:\"try-again\",on:{\"click\":function($event){return _vm.oneMoreTry()}}},[_vm._v(\"再来一局\")])])])]):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"overflow\":\"hidden\"}},[_c('div',{staticClass:\"myself\"},[_c('div',{staticClass:\"avatar\"})])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{staticClass:\"game-this-round\"},[_c('em',[_vm._v(\"本局奖励\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-76b24841\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/game/unlimited.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-76b24841\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./unlimited.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./unlimited.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./unlimited.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-76b24841\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./unlimited.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/game/unlimited.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}